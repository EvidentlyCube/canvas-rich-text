var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,r=(e,r)=>{for(var o in r||(r={}))n.call(r,o)&&i(e,o,r[o]);if(t)for(var o of t(r))a.call(r,o)&&i(e,o,r[o]);return e};const o=new Set(["normal","italic"]),l=new Set(["100","200","300","400","500","600","700","800","900","normal","bold","lighter","bolder"]),s=new Set(["normal","small-caps"]),c=new Set(["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"]),u=new Set(["left","center","right"]),h=new Set(["collapse-all","collapse-outer"]),d=new Set(["space","ignore","preserve"]),p=new Set(["static","varied"]);function g(e){const t=e.text.charAt(0);return" "===t||"\t"===t||"\v"===t||"\f"===t}function f(e,t){const n=[];if(m(e,0,t,n),0===n.length)return{x:0,y:0,width:0,height:0,vertices:[]};const a=n.reduce(((e,t)=>Math.min(e,t.x)),Number.MAX_SAFE_INTEGER),i=n.reduce(((e,t)=>Math.min(e,t.y)),Number.MAX_SAFE_INTEGER);return{x:a,y:i,width:n.reduce(((e,t)=>Math.max(e,t.width+t.x)),0)-a,height:n.reduce(((e,t)=>Math.max(e,t.height+t.y)),0)-i,vertices:n}}function m(e,t,n,a){return e.children.reduce(((t,i)=>i.hasOwnProperty("children")?m(i,t,n,a):function(e,t,n,a,i){let r={height:0,width:0,maxAscent:0,vertices:[]};const o=[r],l={x:0,y:n};let s=!1,c=!0,u=0;const h=new Map;for(const d of e.words){const e="\n"===d.text.charAt(0);if(g(d)||e&&"space"===t.newLine){s=!0,"collapse-all"===t.whiteSpace?u=c?0:t.spaceWidth:"collapse-outer"===t.whiteSpace?c?u=0:u+=t.spaceWidth*d.text.length:u+=d.text.length*t.spaceWidth;continue}if(e){if("ignore"===t.newLine)continue;l.x=0,l.y+=r.height+t.lineSpacing,r={height:0,width:0,maxAscent:0,vertices:[]},o.push(r);continue}const n=a(d);let p=l.x+u,f=l.y;s&&p+n.width>t.width?(c=!0,p=0,u=0,f+=r.height+t.lineSpacing,l.x=n.width,l.y=f,r={height:0,width:0,maxAscent:0,vertices:[]},o.push(r)):l.x=p+n.width;const m=n.maxAscent-n.ascent,y="static"===t.lineHeight?n.maxAscent:n.ascent,w={type:"word",x:p,y:f+("static"===t.lineHeight?m:0),drawOffsetX:n.xOffset,drawOffsetY:n.yOffset,width:n.width,height:n.height,style:d.style,text:d.text};h.set(w,y),r.vertices.push(w),r.width+=u+w.width,r.maxAscent=Math.max(r.maxAscent,y),"static"===t.lineHeight?r.height=Math.max(r.height,n.lineHeight):r.height=Math.max(r.height,n.height),i.push(w),u=0,s=!1,c=!1}for(const d of o)for(const e of d.vertices)e.y+=d.maxAscent-h.get(e);return function(e,t){for(const n of e){const e=t.width-n.width;switch(t.textAlign){case"left":break;case"center":const t=Math.floor(e/2);for(const e of n.vertices)e.x+=t;break;case"right":for(const a of n.vertices)a.x+=e}}}(o,t),l.y+r.height+t.lineSpacing}(i,e.style,t,n,a)),t)}function y(e,t){t.font=`${e.fontStyle} ${e.fontVariant} ${e.fontWeight} ${e.fontStretch} ${e.fontSize}px ${e.fontFamily}`,t.textBaseline="alphabetic",t.fillStyle=e.color}const w="undefined"!=typeof document?document.createElement("canvas"):void 0,v=void 0!==w?w.getContext("2d"):void 0;function b(e){y(e.style,v);const t=v.measureText(e.text),n=v.measureText("WLMIpqjy10");return{width:t.width,height:t.actualBoundingBoxAscent+t.actualBoundingBoxDescent,lineHeight:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent,xOffset:t.actualBoundingBoxLeft,yOffset:t.actualBoundingBoxAscent,ascent:t.actualBoundingBoxAscent,maxAscent:n.actualBoundingBoxAscent}}const x={color:"black",fontSize:14,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontFamily:"arial, sans-serif",width:Number.MAX_SAFE_INTEGER,textAlign:"left",lineSpacing:5,whiteSpace:"collapse-all",spaceWidth:5,newLine:"preserve",lineHeight:"static"};function S(e,t,n,a){y(e.style,t),t.fillText(e.text,e.x+n+e.drawOffsetX,e.y+a+e.drawOffsetY)}const k=new Map([["amp",38],["lt",60],["gt",62],["Entity Name",67],["Agrave",192],["Aacute",193],["Acirc",194],["Atilde",195],["Auml",196],["Aring",197],["AElig",198],["Ccedil",199],["Egrave",200],["Eacute",201],["Ecirc",202],["Euml",203],["Igrave",204],["Iacute",205],["Icirc",206],["Iuml",207],["ETH",208],["Ntilde",209],["Ograve",210],["Oacute",211],["Ocirc",212],["Otilde",213],["Ouml",214],["Oslash",216],["Ugrave",217],["Uacute",218],["Ucirc",219],["Uuml",220],["Yacute",221],["THORN",222],["szlig",223],["agrave",224],["aacute",225],["acirc",226],["atilde",227],["auml",228],["aring",229],["aelig",230],["ccedil",231],["egrave",232],["eacute",233],["ecirc",234],["euml",235],["igrave",236],["iacute",237],["icirc",238],["iuml",239],["eth",240],["ntilde",241],["ograve",242],["oacute",243],["ocirc",244],["otilde",245],["ouml",246],["oslash",248],["ugrave",249],["uacute",250],["ucirc",251],["uuml",252],["yacute",253],["thorn",254],["yuml",255],["Entity Name",83],["nbsp",160],["iexcl",161],["cent",162],["pound",163],["curren",164],["yen",165],["brvbar",166],["sect",167],["uml",168],["copy",169],["ordf",170],["laquo",171],["not",172],["shy",173],["reg",174],["macr",175],["deg",176],["plusmn",177],["sup2",178],["sup3",179],["acute",180],["micro",181],["para",182],["cedil",184],["sup1",185],["ordm",186],["raquo",187],["frac14",188],["frac12",189],["frac34",190],["iquest",191],["times",215],["divide",247],["Entity Name",83],["forall",8704],["part",8706],["exist",8707],["empty",8709],["nabla",8711],["isin",8712],["notin",8713],["ni",8715],["prod",8719],["sum",8721],["minus",8722],["lowast",8727],["radic",8730],["prop",8733],["infin",8734],["ang",8736],["and",8743],["or",8744],["cap",8745],["cup",8746],["int",8747],["there4",8756],["sim",8764],["cong",8773],["asymp",8776],["ne",8800],["equiv",8801],["le",8804],["ge",8805],["sub",8834],["sup",8835],["nsub",8836],["sube",8838],["supe",8839],["oplus",8853],["otimes",8855],["perp",8869],["sdot",8901],["Entity Name",76],["Alpha",913],["Beta",914],["Gamma",915],["Delta",916],["Epsilon",917],["Zeta",918],["Eta",919],["Theta",920],["Iota",921],["Kappa",922],["Lambda",923],["Mu",924],["Nu",925],["Xi",926],["Omicron",927],["Pi",928],["Rho",929],["Sigma",931],["Tau",932],["Upsilon",933],["Phi",934],["Chi",935],["Psi",936],["Omega",937],["alpha",945],["beta",946],["gamma",947],["delta",948],["epsilon",949],["zeta",950],["eta",951],["theta",952],["iota",953],["kappa",954],["lambda",955],["mu",956],["nu",957],["xi",958],["omicron",959],["pi",960],["rho",961],["sigmaf",962],["sigma",963],["tau",964],["upsilon",965],["phi",966],["chi",967],["psi",968],["omega",969],["thetasym",977],["upsih",978],["piv",982],["Entity Name",83],["OElig",338],["oelig",339],["Scaron",352],["scaron",353],["Yuml",376],["fnof",402],["circ",710],["tilde",732],["ensp",8194],["emsp",8195],["thinsp",8201],["zwnj",8204],["zwj",8205],["lrm",8206],["rlm",8207],["ndash",8211],["mdash",8212],["lsquo",8216],["rsquo",8217],["sbquo",8218],["ldquo",8220],["rdquo",8221],["bdquo",8222],["dagger",8224],["Dagger",8225],["bull",8226],["hellip",8230],["permil",8240],["prime",8242],["Prime",8243],["lsaquo",8249],["rsaquo",8250],["oline",8254],["euro",8364],["trade",8482],["larr",8592],["uarr",8593],["rarr",8594],["darr",8595],["harr",8596],["crarr",8629],["lceil",8968],["rceil",8969],["lfloor",8970],["rfloor",8971],["loz",9674],["spades",9824],["clubs",9827],["hearts",9829],["diams",9830]]),A=/&([^#].+?|#\d+);/g;var T,L;(L=T||(T={}))[L.Text=0]="Text",L[L.OpenTag=1]="OpenTag",L[L.CloseTag=2]="CloseTag";const E=/(<.+?>|\n|[^\S\n]+|[^<\s]+)/g,O=/<(\/?[a-zA-Z0-9]+)(.*?)>/,C=/(\S+)="(.+?)"/g;function $(e,t){let n;t.lastIndex=-1;const a=[];for(;n=t.exec(e);)a.push(n);return a}const F=/^[+]?[0-9]+(?:[.][0-9]+)?(?:px)?$/,B=/[^0-9.]/g,q=/^[+-]?[0-9]+(?:[.][0-9]+)?(?:px)?$/,z=/[^0-9.-]/g,N=new Set(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred ","indigo ","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]);function H(e){if("undefined"!=typeof Option){const t=(new Option).style;return t.color=e,""!==t.color}return I.callback()}const I={callback:()=>!1};function W(e,t,n){switch(e){case"color":if(N.has(t.toLowerCase()))return t;if("#"===t.charAt(0))return H(t)?t:void(null==n||n(e,t,`'${t}' is not a valid hex color`));switch(t.substr(0,4).toLowerCase()){case"rgb(":return H(t)?t:void(null==n||n(e,t,`'${t}' is not a valid RGB color`));case"hsl(":return H(t)?t:void(null==n||n(e,t,`'${t}' is not a valid HSL color`));case"rgba":return H(t)?t:void(null==n||n(e,t,`'${t}' is not a valid RGBA color`));case"hsla":return H(t)?t:void(null==n||n(e,t,`'${t}' is not a valid HSLA color`))}return void(null==n||n(e,t,`'${t}' is not a valid color name`));case"fontSize":if(!F.test(t))return void(null==n||n(e,t,`'${t}' is not a valid value for fontSize`));const a=parseFloat(t.replace(B,""));return a<=0?void(null==n||n(e,t,"fontSize must be larger than 0")):a;case"fontFamily":return 0===t.length?void(null==n||n(e,t,"fontFamily cannot be empty")):t;case"fontStyle":return o.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid fontStyle value`));case"fontWeight":return l.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid fontWeight value`));case"fontVariant":return s.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid fontVariant value`));case"fontStretch":return c.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid fontStretch value`));case"textAlign":return u.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid textAlign value`));case"whiteSpace":return h.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid whiteSpace value`));case"newLine":return d.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid newLine value`));case"lineHeight":return p.has(t.toLowerCase())?t:void(null==n||n(e,t,`'${t}' is not a valid lineHeight value`));case"spaceWidth":return q.test(t)?parseFloat(t.replace(z,"")):void(null==n||n(e,t,`'${t}' is not a valid value for spaceWidth`));case"lineSpacing":return q.test(t)?parseFloat(t.replace(z,"")):void(null==n||n(e,t,`'${t}' is not a valid value for lineSpacing`))}}function M(e,t){const n={};for(const a in e){if(!e.hasOwnProperty(a))continue;const i=a.toLowerCase();if(t.hasOwnProperty(i)){const r=t[i],o=W(r,e[a]);void 0!==o&&(n[r]=o)}}return n}function P(e){return"p"===e||"div"===e}function R(e){switch(e){case"b":case"strong":return{fontWeight:"bold"};case"em":case"i":return{fontStyle:"italic"};default:return{}}}const j={fontsize:"fontSize",size:"fontSize",fontvariant:"fontVariant",variant:"fontVariant",fontfamily:"fontFamily",family:"fontFamily",fontweight:"fontWeight",weight:"fontWeight",fontstyle:"fontStyle",style:"fontStyle",fontstretch:"fontStretch",stretch:"fontStretch",color:"color",width:"width",newline:"newLine",linespacing:"lineSpacing",spacewidth:"spaceWidth",whitespace:"whiteSpace",textalign:"textAlign",align:"textAlign",lineheight:"lineHeight"};function V(e,t){const n=r(r({},x),t),a={children:[],style:n},i=[],o=[];let l,s=a,c=n;e=e.replace(/\r\n/g,"\n");for(const u of function(e){return $(e,E).map((e=>e[0])).reduce(((e,t)=>{if("<"===t.charAt(0)){const n=t.match(O);if(!n)return e;const[,a,i]=n;if("/"===a.charAt(0))return e.push({type:2,tag:a.substr(1).toLowerCase()}),e;const r=Array.from($(i,C)).reduce(((e,t)=>(e[t[1]]=t[2],e)),{});return e.push({type:1,tag:a.toLowerCase(),style:r}),"/"===t.charAt(t.length-2)&&e.push({type:2,tag:`${a.toLowerCase()}`}),e}var n;return e.push({type:0,text:(n=t,n.replace(A,((e,t)=>{const n=k.get(t.toLowerCase());return n?String.fromCharCode(n):"#"===t.charAt(0)?String.fromCharCode(parseInt(t.substr(1))):`&${t};`})))}),e}),[])}(e))switch(u.type){case T.Text:l||(l={words:[]},s.children.push(l)),l.words.push({text:u.text,style:c});break;case T.OpenTag:if(P(u.tag)){o.push(c),c=r(r({},c),M(u.style,j));const e={children:[],style:c};s.children.push(e),i.push(s),s=e,l=void 0}else"br"===u.tag?l=void 0:(o.push(c),c=r(r(r({},c),R(u.tag)),M(u.style,j)));break;case T.CloseTag:if(P(u.tag)){const e=s;s=i.pop(),l=void 0,0===e.children.length&&s.children.splice(s.children.indexOf(e),1),c=o.pop()}else"br"===u.tag||(c=o.pop())}return a}const D=document.getElementsByTagName("canvas")[0],G=D.getContext("2d"),X=document.getElementsByTagName("textarea")[0];function _(e){return Array.from(document.querySelectorAll(`input[name="${e}"], #${e}`)).map((e=>"checkbox"===e.type||"radio"===e.type?e.checked?e.value:void 0:e.value)).filter((e=>void 0!==e)).join(" ")}function U(){G.fillStyle="#DDF8F8",G.fillRect(0,0,D.width,D.height);const e=parseInt(_("wrap-width")),t=parseInt(_("draw-x")),n=parseInt(_("draw-y")),a=_("text-align"),i=V(X.value,{color:_("color"),fontSize:parseInt(_("font-size")),fontStyle:_("font-style"),fontWeight:_("font-weight"),fontStretch:_("font-stretch"),fontFamily:_("font-family"),fontVariant:_("font-variant"),spaceWidth:parseInt(_("space-width")),width:e,lineSpacing:parseInt(_("line-spacing")),newLine:_("new-line"),whiteSpace:_("white-space"),textAlign:a,lineHeight:_("line-height")}),r=f(i,b);const o=_("pull-to-top-left"),l=o?-r.x:0,s=o?-r.y:0,c=t+r.x+l,u=n+r.y+s;if(G.clearRect(0,0,500,500),_("show-vertices")){G.fillStyle="#CCFFFF";for(const e of r.vertices)G.fillRect(t+l+e.x,n+s+e.y,e.width,e.height)}if(_("show-render-bounds")&&(G.beginPath(),G.strokeStyle="#0000FF",G.setLineDash([3,3]),G.moveTo(c,u),G.lineTo(c+r.width,u),G.lineTo(c+r.width,u+r.height),G.lineTo(c,u+r.height),G.lineTo(c,u),G.stroke()),_("show-word-wrap-edge")){G.beginPath(),G.strokeStyle="#FF0000",G.setLineDash([5,5]);const n=e+t+l,i=t+l;switch(a){case"left":G.moveTo(n,0),G.lineTo(n,500),G.stroke();break;case"center":G.moveTo(n,0),G.lineTo(n,500),G.stroke(),G.moveTo(i,0),G.lineTo(i,500),G.stroke();break;case"right":G.moveTo(i,0),G.lineTo(i,500),G.stroke()}}!function(e,t,n,a){for(const i of e.vertices)S(i,t,n,a)}(r,G,t+l,n+s)}X.value='Hello!<br/>\nText\nWith\nNewlines\n<p>\n\t<b>&lt;b&gt;strong&lt;/b&gt;</b>\n\t<strong>&lt;strong&gt;strong&lt;/strong&gt;</strong>\n</p>\n<p>\n\t<i>&lt;i&gt;italic&lt;/i&gt;</i>\n\t<em>&lt;em&gt;italic&lt;/em&gt;</em>\n</p>\n<p size="30px">\n\tStarts\n\t<span size="25px">big</span>\n\t<span size="20px">but</span>\n\t<span size="15px">gets</span>\n\t<span size="10px">smaller</span>\n</p>\n<p>\n\tColors:\n\t<span color="rgb(0, 50, 50)">RGB</span>\n\t<span color="rgba(0, 50, 50, 0.3)">RGBA</span>\n\t<span color="hsl(0, 50%, 50%)">HSL</span>\n\t<span color="hsla(0, 50%, 50%, 0.3)">HSLA</span>\n\t<span color="#F0F">Hex Short</span>\n\t<span color="#00FF88">Hex Long</span>\n\t<span color="aquamarine">Named</span>\n</p>\n<p>\n\t<span family="arial">Arial</span>\n\t<span family="verdana">Verdana</span>\n\t<span family="serif">Serif</span>\n\t<span family="Comic Sans MS">Comic Sans MS</span>\n\t<span family="courier">Courier</span>\n\t<span family="webdings">qwe</span>\n\t<span family="fantasy">cursive</span>\n</p>\n<p variant="small-caps">Very small caps</p>\n',Array.from(document.getElementsByTagName("input")).forEach((e=>{e.addEventListener("input",(()=>U()))})),Array.from(document.getElementsByTagName("select")).forEach((e=>{e.addEventListener("input",(()=>U()))})),X.addEventListener("input",(()=>U())),U();
